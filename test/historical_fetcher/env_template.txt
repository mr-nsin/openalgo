# OpenAlgo-Integrated Historical Data Fetcher Configuration Template
# Copy this file to .env and fill in your actual values
# This configuration integrates with OpenAlgo's existing environment variables

# =============================================================================
# OpenAlgo Integration
# =============================================================================
# The historical fetcher reuses OpenAlgo's existing configuration
# Make sure these match your main OpenAlgo .env file

# OpenAlgo Database (for symtoken table and authentication)
# This should match your main OpenAlgo .env file
DATABASE_URL=sqlite:///db/openalgo.db

# OpenAlgo Broker Configuration (reused for historical data)
# These should match your main OpenAlgo .env file
BROKER_API_KEY=your_zerodha_api_key_here
BROKER_API_SECRET=your_zerodha_access_token_here

# Note: The historical fetcher uses OpenAlgo's authentication system
# It will automatically get the auth token from OpenAlgo's database
# If no token is found, it will use BROKER_API_KEY and BROKER_API_SECRET directly

# =============================================================================
# QuestDB Configuration (for historical data storage)
# =============================================================================
HIST_FETCHER_QUESTDB_HOST=localhost
HIST_FETCHER_QUESTDB_PORT=9000
HIST_FETCHER_QUESTDB_USERNAME=
HIST_FETCHER_QUESTDB_PASSWORD=
HIST_FETCHER_QUESTDB_DATABASE=qdb

# =============================================================================
# Processing Configuration
# =============================================================================
HIST_FETCHER_API_REQUESTS_PER_SECOND=3
HIST_FETCHER_MAX_CONCURRENT_REQUESTS=5
HIST_FETCHER_BATCH_SIZE=50
HIST_FETCHER_HISTORICAL_DAYS_LIMIT=365

# =============================================================================
# Data Configuration
# =============================================================================
# Comma-separated list of timeframes to fetch
HIST_FETCHER_ENABLED_TIMEFRAMES=1m,5m,15m,1h,D

# Comma-separated list of instrument types to fetch
HIST_FETCHER_ENABLED_INSTRUMENT_TYPES=EQ,FUT,CE,PE,INDEX

# Comma-separated list of exchanges to include
HIST_FETCHER_ENABLED_EXCHANGES=NSE,BSE,NFO,BFO,NSE_INDEX,BSE_INDEX

# Optional: Override start date (format: YYYY-MM-DD)
# HIST_FETCHER_START_DATE_OVERRIDE=2024-01-01

# =============================================================================
# Notification Configuration (Optional - integrates with OpenAlgo)
# =============================================================================
# The historical fetcher can reuse OpenAlgo's notification system
# If you have notifications configured in OpenAlgo, they will be used automatically

# Telegram Notifications (reuses OpenAlgo's TELEGRAM_BOT_TOKEN if available)
# HIST_FETCHER_TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
# HIST_FETCHER_TELEGRAM_CHAT_IDS=["your_chat_id_here"]

# Email Notifications (optional, separate from OpenAlgo)
HIST_FETCHER_SMTP_HOST=smtp.gmail.com
HIST_FETCHER_SMTP_PORT=587
HIST_FETCHER_SMTP_USERNAME=your_email@gmail.com
HIST_FETCHER_SMTP_PASSWORD=your_app_password_here
# JSON array format: ["email1@domain.com","email2@domain.com"]
HIST_FETCHER_EMAIL_RECIPIENTS=["recipient@email.com"]

# =============================================================================
# Logging Configuration
# =============================================================================
HIST_FETCHER_LOG_LEVEL=INFO
HIST_FETCHER_LOG_FILE_PATH=logs/historical_fetcher.log
HIST_FETCHER_LOG_ROTATION=100 MB
HIST_FETCHER_LOG_RETENTION=30 days

# =============================================================================
# Performance Configuration
# =============================================================================
HIST_FETCHER_ENABLE_PERFORMANCE_MONITORING=true
HIST_FETCHER_MEMORY_LIMIT_MB=4096

# =============================================================================
# OpenAlgo Integration Notes:
# =============================================================================
# 1. This historical fetcher integrates with OpenAlgo's existing infrastructure
# 2. It reuses OpenAlgo's database (symtoken table) and authentication system
# 3. Zerodha API credentials are taken from OpenAlgo's BROKER_API_KEY and BROKER_API_SECRET
# 4. The fetcher uses OpenAlgo's existing Zerodha API implementation
# 5. QuestDB should be running before starting the fetcher
# 6. Adjust batch sizes and concurrency based on your system capabilities
# 7. The fetcher automatically discovers symbols from OpenAlgo's database
# 8. For Telegram notifications, it can reuse OpenAlgo's TELEGRAM_BOT_TOKEN if configured
# 9. For Gmail, use an App Password instead of your regular password
